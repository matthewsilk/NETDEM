hdi(results[[10]][[4]][,3], cred_int = 0.89)
chain_infoM1<-matrix(NA,nr=length(results),nc=4)
for(i in 1:length(results)){
if(length(results[[i]])>0){
chain_infoM1[i,1:2]<-hdi(results[[i]][[1]][,3], cred_int = 0.89)
chain_infoM1[i,3]<-sum(results[[i]][[1]][,3]>0)/nrow(results[[i]][[1]])
chain_infoM1[i,4]<-ifelse(0<chain_infoM1[i,1]|0>chain_infoM1[i,2],1,0)
}
}
chain_infoM2<-matrix(NA,nr=length(results),nc=4)
for(i in 1:length(results)){
if(length(results[[i]])>0){
chain_infoM2[i,1:2]<-hdi(results[[i]][[2]][,3], cred_int = 0.89)
chain_infoM2[i,3]<-sum(results[[i]][[2]][,3]>0)/nrow(results[[i]][[2]])
chain_infoM2[i,4]<-ifelse(0<chain_infoM2[i,1]|0>chain_infoM2[i,2],1,0)
}
}
chain_infoM3<-matrix(NA,nr=length(results),nc=4)
for(i in 1:length(results)){
if(length(results[[i]])>0){
chain_infoM3[i,1:2]<-hdi(results[[i]][[3]][,3], cred_int = 0.89)
chain_infoM3[i,3]<-sum(results[[i]][[3]][,3]>0)/nrow(results[[i]][[3]])
chain_infoM3[i,4]<-ifelse(0<chain_infoM3[i,1]|0>chain_infoM3[i,2],1,0)
}
}
chain_infoM4<-matrix(NA,nr=length(results),nc=4)
for(i in 1:length(results)){
if(length(results[[i]])>0){
chain_infoM4[i,1:2]<-hdi(results[[i]][[4]][,3], cred_int = 0.89)
chain_infoM4[i,3]<-sum(results[[i]][[4]][,3]>0)/nrow(results[[i]][[4]])
chain_infoM4[i,4]<-ifelse(0<chain_infoM4[i,1]|0>chain_infoM4[i,2],1,0)
}
}
boxplot(chain_infoM1[which(complete.cases(chain_infoM1[,3])==TRUE),3]~test_data$net_vars[test_data$m_inf=="M1"&test_data$conv==1]*test_data$net_effs[test_data$m_inf=="M1"&test_data$conv==1])
dim(chain_infoM1[which(complete.cases(chain_infoM1[,3])==TRUE),])
dim(chain_infoM2[which(complete.cases(chain_infoM1[,3])==TRUE),])
dim(chain_infoM3[which(complete.cases(chain_infoM1[,3])==TRUE),])
dim(chain_infoM4[which(complete.cases(chain_infoM1[,3])==TRUE),])
test_data_add<-matrix(NA,nr=nrow(test_data),nc=4)
test_data_add[which(test_data$m_inf=="M1"),]<-chain_infoM1[which(complete.cases(chain_infoM1[,3])==TRUE),]
test_data_add[test_data$m_inf=="M2",]<-chain_infoM2[which(complete.cases(chain_infoM2[,3])==TRUE),]
test_data_add[test_data$m_inf=="M3",]<-chain_infoM3[which(complete.cases(chain_infoM3[,3])==TRUE),]
test_data_add[test_data$m_inf=="M4",]<-chain_infoM4[which(complete.cases(chain_infoM4[,3])==TRUE),]
test_data_add<-data.frame(test_data_add)
names(test_data_add)<-c("cIlo","CIhi","Big0","StatClear")
test_data2<-data.frame(test_data,test_data_add)
boxplot(Big0~pcg*net_effs*net_vars,data=test_data2[test_data2$conv==1&test_data2$m_inf%in%c("M1","M2"),])
boxplot(Big0~m_inf*p_wr_i*net_effs*net_vars,data=test_data2[test_data2$conv==1&test_data2$m_inf%in%c("M1","M2")&test_data2$pcg==0.75,])
boxplot(Big0~m_inf*p_wr_i*net_effs*net_vars,data=test_data2[test_data2$conv==1&test_data2$m_inf%in%c("M1","M2")&test_data2$pcg==0.25,])
boxplot(Big0~net_cov*net_effs*net_vars,data=test_data2[test_data2$conv==1&test_data2$m_inf%in%c("M1","M2")&test_data2$pcg==0.25,])
boxplot(Big0~net_cov*net_effs*net_vars,data=test_data2[test_data2$conv==1&test_data2$m_inf%in%c("M1","M2")&test_data2$pcg==0.75,])
test_data2A<-test_data2[test_data2$conv==1,]
aggregate(test_data2A$StatClear,by=list(test_data2A$m_inf,test_data2A$net_vars,test_data2A$net_effs),mean)
aggregate(test_data2A$StatClear,by=list(test_data2A$m_inf,test_data2A$net_vars,test_data2A$net_effs,test_data2A$pcg),mean)
aggregate(test_data2A$StatClear,by=list(test_data2A$m_inf,test_data2A$net_vars,test_data2A$net_effs,test_data2A$pcg),mean)
aggregate(test_data2A$StatClear,by=list(test_data2A$pcg,test_data2A$m_inf,test_data2A$net_vars,test_data2A$net_effs),mean)
aggregate(test_data2$conv,by=list(test_data2$pcg,test_data2$m_inf,test_data2$net_effs,test_data2$net_vars),mean)
######################
#####################
library(emdist)
a<-density(results[[1]][[1]][,3])
b<-density(results[[1]][[3]][,3])
c<-density(results[[1]][[2]][,3])
d<-density(results[[1]][[4]][,3])
emd(cbind(a$y,a$x),cbind(b$y,b$x),max.iter=10000)
emd(cbind(c$y,c$x),cbind(d$y,d$x),max.iter=10000)
emds<-matrix(NA,nr=length(results),nc=2)
for(i in 1:nrow(emds)){
if(length(results[[i]])>0){
a<-density(results[[i]][[1]][,3])
b<-density(results[[i]][[3]][,3])
c<-density(results[[i]][[2]][,3])
d<-density(results[[i]][[4]][,3])
emds[i,1]<-emd(cbind(a$y,a$x),cbind(b$y,b$x),max.iter=1000)
emds[i,2]<-emd(cbind(c$y,c$x),cbind(d$y,d$x),max.iter=1000)
}
}
emds2<-emds[complete.cases(emds[,1]),]
emd_pars<-data.frame(pars1,emds2)
boxplot(X1~net_effs*net_vars,data=emd_pars,ylim=c(0,2))
boxplot(X2~pcg*net_effs*net_vars,data=emd_pars,ylim=c(0,2))
boxplot(X2~pcg*net_effs*net_vars,data=emd_pars,ylim=c(0,2))
boxplot(X1~pcg*net_effs*net_vars,data=emd_pars,ylim=c(0,2))
boxplot(X2~net_cov*pcg*net_effs*net_vars,data=emd_pars,ylim=c(0,2))
emd_pars$conv1<-test_data2$conv[test_data2$m_inf=="M1"]
emd_pars$conv2<-test_data2$conv[test_data2$m_inf=="M2"]
par(mfrow=c(1,2))
boxplot(X1~net_effs*net_vars,data=emd_pars[emd_pars$conv1==1,],ylim=c(0,2))
boxplot(X2~net_effs*net_vars,data=emd_pars[emd_pars$conv2==1,],ylim=c(0,2))
par(mfrow=c(1,1))
boxplot(X2~pcg*net_effs*net_vars,data=emd_pars[emd_pars$conv2==1,],ylim=c(0,2))
par(mfrow=c(1,2))
boxplot(X1~pcg*net_effs*net_vars,data=emd_pars[emd_pars$conv1==1,],ylim=c(0,2))
boxplot(X2~pcg*net_effs*net_vars,data=emd_pars[emd_pars$conv2==1,],ylim=c(0,2))
par(mfrow=c(1,1))
par(mfrow=c(2,2))
boxplot(Beta3~pcg*net_vars*net_effs,data=test_data[test_data$conv==1&test_data$m_inf=="M1",],ylim=c(-0.25,1.25))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.4,0.4),lty=2)
lines(x=c(-100,100),y=c(0.8,0.8),lty=2)
boxplot(Beta3~pcg*net_vars*net_effs,data=test_data[test_data$conv==1&test_data$m_inf=="M2",],ylim=c(-0.25,1.25))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.4,0.4),lty=2)
lines(x=c(-100,100),y=c(0.8,0.8),lty=2)
boxplot(Beta3~pcg*net_vars*net_effs,data=test_data[test_data$conv==1&test_data$m_inf=="M3",],ylim=c(-0.25,1.25))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.4,0.4),lty=2)
lines(x=c(-100,100),y=c(0.8,0.8),lty=2)
boxplot(Beta3~pcg*net_vars*net_effs,data=test_data[test_data$conv==1&test_data$m_inf=="M4",],ylim=c(-0.25,1.25))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.4,0.4),lty=2)
lines(x=c(-100,100),y=c(0.8,0.8),lty=2)
par(mfrow=c(1,1))
boxplot(X2~net_cov*pcg*net_effs*net_vars,data=emd_pars[emd_pars$conv1==2,],ylim=c(0,2))
boxplot((Beta2-Beta1)~net_effs*net_vars*pcg,data=test_data2A,ylim=c(-0.2,1.4))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.5,0.5),lty=2)
boxplot((Beta2-Beta1)~m_inf,data=test_data2A,ylim=c(-0.2,1.4))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.5,0.5),lty=2)
boxplot(boot::inv.logit(Beta1)~net_effs*net_vars*pcg,data=test_data2A,ylim=c(0,1))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(0.8,0.8),lty=2)
boxplot(p~net_effs*net_vars*pcg,data=test_data2A,ylim=c(0,1))
lines(x=c(-100,100),y=c(0,0))
lines(x=c(-100,100),y=c(1-0.75^5,1-0.75^5),lty=2)
lines(x=c(-100,100),y=c(1-0.5^5,1-0.5^5),lty=2)
lines(x=c(-100,100),y=c(1-0.25^5,1-0.25^5),lty=2)
exp_mean<-(boot::inv.logit(boot::logit(0.8)+0.5)+0.8)/2
true_surv<-matrix(NA,nr=length(results),nc=10)
for(i in 1:length(results)){
if(length(results[[i]])>0){
true_surv[i,]<-unlist(lapply(results[[i]][[5]],colMeans))[seq(2,20,2)]
}
}
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
boxplot(chain_info[,3]~test_data$pcg*test_data$net_vars*test_data$net_effs)
boxplot(chain_info[,3]~test_data$ng*test_data$net_vars*test_data$net_effs)
boxplot(test_data$Beta3~test_data$pcg*test_data$net_vars*test_data$net_effs)
boxplot(chain_info[,3]~test_data$pmi*test_data$net_vars*test_data$net_effs)
aggregate(chain_info[,3],by=list(test_data$ng,test_data$net_vars,test_data$net_effs),median)
aggregate(chain_info[,3],by=list(test_data$pcg,test_data$net_vars,test_data$net_effs),median)
boxplot(chain_info[,3]~test_data$ng*test_data$pmi*test_data$net_vars*test_data$net_effs)
aggregate(chain_info[,4],by=list(test_data$ng,test_data$net_vars,test_data$net_effs),mean)
aggregate(chain_info[,4],by=list(test_data$pcg,test_data$net_vars,test_data$net_effs),mean)
boxplot(chain_info[,3][test_data$pmi==1]~test_data$pcg[test_data$pmi==1]*test_data$net_vars[test_data$pmi==1]*test_data$net_effs[test_data$pmi==1])
boxplot(chain_info[,3][test_data$pmi==1]~test_data$ng[test_data$pmi==1]*test_data$net_vars[test_data$pmi==1]*test_data$net_effs[test_data$pmi==1])
aggregate(as.data.frame(chain_info[,4]),by=list(test_data$ng,test_data$pmi,test_data$pcg,test_data$net_vars,test_data$net_effs),mean)
aggregate(as.data.frame(chain_info[,4]),by=list(test_data$pmi,test_data$pcg,test_data$net_vars,test_data$net_effs),mean)
chain_info2<-data.frame(chain_info,test_data)
names(chain_info2)[1:4]<-c("lowCI","highCI","greater0","CIout")
mod<-glm(CIout~as.factor(ng)*net_vars*as.factor(net_effs),data=chain_info2,family=binomial)
summary(mod)
mod<-glm(CIout~as.factor(pcg)*net_vars*as.factor(net_effs),data=chain_info2,family=binomial)
summary(mod)
mod<-glm(CIout~as.factor(pmi)*net_vars*as.factor(net_effs),data=chain_info2,family=binomial)
summary(mod)
###########
mod<-glm(CIout~as.factor(ng)*net_vars*as.factor(net_effs),data=chain_info2[chain_info2$pmi==1,],family=binomial)
summary(mod)
mod<-glm(CIout~as.factor(pcg)*net_vars*as.factor(net_effs),data=chain_info2[chain_info2$pmi==1,],family=binomial)
summary(mod)
###########
#install.packages("emdist")
library(emdist)
a<-hist(results[[1]][,3],breaks=seq(-1,1,0.02))
b<-hist(results[[2]][,3],breaks=seq(-1,1,0.02))
emd(cbind(a$counts,a$mids),cbind(b$counts,b$mids))
a<-density(results[[1]][,3])
b<-density(results[[2]][,3])
emd(cbind(a$y,a$x),cbind(b$y,b$x),max.iter=10000)
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9))
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival")
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolour("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolour("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolour("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolour("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=3,col="red")
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=3,col="red")
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="orange",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="yellow",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
par(mfrow=c(1,1))
mtext("M1",side=3,adj=0.95,cex=1.5,line=-2)
mtext("M1",side=3,adj=0.99,cex=1.5,line=-0.5)
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M1",side=3,adj=0.95,cex=1.5,line=-0.5)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M1",side=3,adj=0.95,cex=1.5,line=-1.5)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M1",side=3,adj=0.95,cex=1.5,line=-2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mts<-mean(rowMeans(true_surv[complete.cases(true_surv[,1]),]))
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M1"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M1"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M1",side=3,adj=0.95,cex=1.5,line=-2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M2"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M2"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M2",side=3,adj=0.95,cex=1.5,line=-2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M3"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M3"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M3",side=3,adj=0.95,cex=1.5,line=-2)
plot((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"]))/2~rowMeans(true_surv[complete.cases(true_surv[,1]),]),ylim=c(0.7,0.9),xlim=c(0.7,0.9),pch=16,col=adjustcolor("light grey",0.2),las=1,ylab="Model estimate",xlab="Mean survival",cex.lab=1.4)
lines(x=c(exp_mean,exp_mean),y=c(-100,100),lwd=2,col="black",lty=2)
lines(y=c(exp_mean,exp_mean),x=c(-100,100),lwd=2,col="black",lty=2)
mms<-mean((boot::inv.logit(test_data2$Beta1[test_data2$m_inf=="M4"&test_data2$conv==1])+boot::inv.logit(test_data2$Beta2[test_data2$m_inf=="M4"&test_data2$conv==1]))/2)
points(x=mts,y=mts,cex=3,col="firebrick",pch=8,lwd=3)
points(x=mms,y=mms,cex=2,col="cornflowerblue",pch=8,lwd=2)
mtext("M4",side=3,adj=0.95,cex=1.5,line=-2)
par(mfrow=c(1,1))
